<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Katalog Kapsli</title>
  <style>
    body {
      font-family: sans-serif;
      padding: 20px;
      background: #f8f8f8;
    }
    h1 {
      text-align: center;
    }
    .filter {
      text-align: center;
      margin: 20px 0;
    }
    .caps {
      display: block;
    }
    .cap {
      background: white;
      padding: 10px;
      border-radius: 8px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
      margin-bottom: 10px;
    }
    .gallery {
      display: flex;
      gap: 5px;
      overflow-x: auto;
      padding-bottom: 5px;
    }
    .gallery img {
      height: 100px;
      border-radius: 4px;
      border: 1px solid #ccc;
    }
    .cap h3 {
      margin: 10px 0 5px;
    }
    .cap small {
      color: gray;
    }
  </style>
</head>
<body>
  <h1>Kolekcja Kapsli</h1>
  <div class="filter">
    <label for="country-select">Filtruj według kraju:</label>
    <select id="country-select">
      <option value="all">Wszystkie</option>
    </select>
    <br/><br/>
    <label for="search-input">Szukaj po nazwie lub opisie:</label>
    <input type="text" id="search-input" placeholder="Wpisz szukaną frazę..."/>
  </div>
  <div id="counter"></div>
  <div class="caps" id="caps-container"></div>

  <script>
    let caps = [];

    async function loadCaps() {
      const response = await fetch('caps.json');
      caps = await response.json(); // Wczytanie danych kapsli
      const container = document.getElementById('caps-container');
      const select = document.getElementById('country-select');
      const counter = document.getElementById('counter');
      const searchInput = document.getElementById('search-input');

      // Uzupełnienie listy krajów
      const countries = Array.from(new Set(caps.map(c => c.country)));
      countries.forEach(c => {
        const opt = document.createElement('option');
        opt.value = c;
        opt.textContent = c;
        select.appendChild(opt);
      });

      // Funkcja renderująca kapsle
      function render(selectedCountry = 'all', searchTerm = '') {
        container.innerHTML = '';

        let filtered = caps;

        // Filtruj po kraju
        if (selectedCountry !== 'all') {
          filtered = filtered.filter(c => c.country === selectedCountry);
        }

        // Filtruj po wyszukiwaniu
        if (searchTerm.trim() !== '') {
          const lowerSearchTerm = searchTerm.toLowerCase();
          filtered = filtered.filter(c => 
            c.name.toLowerCase().includes(lowerSearchTerm) ||
            c.description.toLowerCase().includes(lowerSearchTerm)
          );
        }

        counter.textContent = `Łącznie kapsli: ${filtered.length}`;

        // Unikalne nazwy kapli
        const uniqueNames = Array.from(new Set(filtered.map(c => c.name)));

        // Dla każdej unikalnej nazwy wyświetlamy sekcję
        uniqueNames.sort((a, b) => a.localeCompare(b)).forEach(name => {
          const section = document.createElement('div');
          
          // Nagłówek nazwy kapsla
          const header = document.createElement('
